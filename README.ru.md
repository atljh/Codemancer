# Codemancer: Тактический командный центр для AI-нативной разработки

Codemancer — это не просто IDE. Это **тактический интерфейс управления реальностью кода**, созданный для эпохи, где разработка — это не написание строк, а управление мощными ИИ-агентами.

Построен на Tauri 2.0 + React 19 + Python FastAPI. Работает как визуальный компаньон для CLI-инструментов вроде Claude Code, предоставляя UI для того, чего терминал не может: визуализация, трекинг и интерактивные панели.

[English README](README.md) | [README українською](README.uk.md)

![Codemancer Screenshot](docs/screenshot.png)

## Видение

Современные инструменты (VS Code, Cursor) — это наследие прошлого. Они заставляют человека работать «микроменеджером» текста. Codemancer переносит тебя на уровень **Стратега**.

Пока твой ИИ-агент оперирует файлами и терминалом, ты видишь общую картину боя:

- **Интеллект вместо текста** — ты общаешься с проектом как с живым организмом
- **Дофамин вместо выгорания** — каждая решённая задача — это захваченный сектор и рост твоего влияния
- **Контекст вместо хаоса** — визуальные карты зависимостей и радары техдолга заменяют тысячи открытых вкладок

## Ключевые возможности

### Тактическая карта

Интерактивный граф зависимостей с эффектом «тумана войны». Видь **Blast Radius** своих изменений до того, как они сломают систему. Оранжевая подсветка показывает затронутые модули когда ИИ пишет файлы.

### Агентные инструменты (The Hands)

Агент обладает полным доступом к `list_files`, `read_file`, `write_file`, `search_text` и `run_command`. Он не просто советует — он исполняет. Упавшие команды наносят урон HP; агент автоматически предлагает план ремонта.

### Радар здоровья и техдолга

Радарная диаграмма аномалий. Преврати рефакторинг в зачистку «красных зон» сложности и техдолга. Фоновый мониторинг здоровья предупреждает о критических аномалиях: `[CRITICAL_ANOMALY]: Обнаружена нестабильность в секторе src/logic`.

### Хроника сессий

Автоматическая база знаний всех действий. Генерация PR-отчётов и стендапов в один клик. **Кросс-сессионная память** — агент вспоминает предыдущую работу над тем же кодом: `[RECALLING_DATA]: Ранее мы работали над этим модулем...`

### Проактивный ассистент (Ambient Thinking)

Фоновый пульс каждые 5 минут анализирует `git diff` и паттерны ошибок. Если найдено что-то важное, агент инициирует диалог сам: `[PROACTIVE_LOG]: Анализ фоновых процессов завершён. Обнаружена избыточность. Оператор, инициировать стабилизацию?`

### Нейронный голосовой канал

Голосовой ввод через кнопку микрофона в командной строке. Web Speech API TTS озвучивает ответы ИИ. Процедурный аудио-движок: scanning-тоны при использовании инструментов, glitch-шум при ошибках, аккорд успеха при завершении.

### Режим глубокого погружения

RPG-таймер фокуса с множителем опыта (x2 EXP). Работа в потоке восстанавливает твою ментальную «Ману».

### Визуальные эффекты присутствия

Анимированная волновая форма в хедере пульсирует когда ИИ думает. Когда HP падает ниже 20%, весь UI получает glitch-эффект искажения с красной виньеткой — твои системы выходят из строя, Оператор.

### RPG-система прогрессии

- **EXP и уровни** — получай опыт за действия в коде (сообщения, коммиты, исправление багов, сохранение файлов)
- **HP / MP** — HP убывает от упавших команд, MP тратится на использование инструментов
- **Режим фокуса** — таймер в стиле Pomodoro с множителем EXP x2
- **Уведомления о повышении уровня** с визуальными эффектами

### AI-чат ассистент

- **Мульти-провайдерная поддержка** — Anthropic Claude, OpenAI GPT, Google Gemini, Custom (Ollama, локальные LLM)
- **Потоковые ответы** с интеграцией инструментов
- **Сохранение диалогов** — автосохранение, восстановление между сессиями
- **Инъекция контекста проекта** — AI понимает твою кодовую базу
- **Тактическая личность** — агент обращается к тебе «Оператор» и докладывает в аналитическом стиле с процентами уверенности

### Встроенный редактор кода

- **Monaco Editor** с 4 sci-fi темами
- **Табовое редактирование** нескольких файлов
- **Проверка синтаксиса** (Python, JavaScript, TypeScript)
- **Просмотр diff** — сравнение кода side-by-side
- **Файловый эксплорер** с деревом навигации

### Визуальный Git-клиент

- **Панель Git-статуса** — staged, unstaged, untracked файлы с иконками статуса
- **Stage/unstage** отдельных файлов
- **Inline коммит** с полем ввода сообщения
- **AI-генерация сообщений коммитов**
- **Отмена изменений** по файлам

### Инструменты продуктивности

- **Палитра команд** (Cmd+K) — 20+ встроенных команд
- **Быстрое открытие** (Cmd+P) — fuzzy-поиск файлов
- **Поиск по файлам** с превью результатов
- **Найти и заменить** по всему проекту
- **Система квестов** — автосканирование TODO/FIXME и превращение их в квесты

### Темы и локализация

- **4 темы**: Dark Ops (cyan), Midnight (blue), Phantom (amber), Arctic (light blue)
- **2 языка**: английский, русский
- **Sci-fi / тактическая эстетика** с эффектами glass morphism

## Философия

- **AI-First**: Интерфейс абстрагирован от файлов. Код — это артефакт, а не центр внимания.
- **Visual Context**: Если это нельзя увидеть на карте, этого не существует.
- **Proactive Assistance**: Твой агент говорит первым, если чует опасность в секторе.

## Архитектура

```
src/                        # React 19 + TypeScript + Vite 7
  components/               # 40+ компонентов в 15 функциональных областях
    bars/                   # Полоска EXP, стат-бары
    chat/                   # OmniChat, пузыри (сообщения, здоровье, recall, blast, proactive)
    editor/                 # Monaco-редактор, табы файлов
    explorer/               # Файловое дерево
    focus/                  # Таймер фокуса
    git/                    # Панель Git-статуса
    health/                 # Метрики кода, радар-чарт
    layout/                 # 3-панельный layout, верхний стат-бар
    map/                    # Тактическая карта зависимостей
    modals/                 # Палитра команд, настройки, diff-просмотр и др.
    chronicle/              # Журнал сессий
    welcome/                # Экран первого запуска
    ui/                     # Glass card, glow panel, waveform visualizer
  stores/gameStore.ts       # Zustand 5 — единый глобальный стор
  hooks/                    # useApi, useAudio, useHealthWatch, useProactivePulse и др.
  types/game.ts             # Все TypeScript-интерфейсы
  i18n/translations.ts      # EN/RU переводы (250+ ключей)
  themes/                   # CSS custom properties, 4 темы

backend/                    # Python 3.12+ FastAPI
  routes/                   # 13 API-роутеров, 60+ эндпоинтов
  models/                   # Pydantic-модели
  services/                 # Бизнес-логика
    providers/              # AI-провайдеры (Anthropic, OpenAI, Gemini, Custom)
  conversations/            # JSON-файлы — сохранённые диалоги
  state.json                # Состояние игрока

src-tauri/                  # Rust — Tauri 2.0 оболочка
  src/lib.rs                # Настройка приложения, жизненный цикл Python-процесса, OAuth
```

## Требования

- **Node.js** >= 18
- **pnpm** (рекомендуется) или npm
- **Rust** (последняя стабильная версия) — [установка через rustup](https://rustup.rs/)
- **Python** >= 3.12
- **uv** — менеджер пакетов Python — [установка](https://docs.astral.sh/uv/getting-started/installation/)
- **Системные зависимости Tauri 2** — [руководство по платформам](https://v2.tauri.app/start/prerequisites/)

### macOS

```bash
# Установка Xcode Command Line Tools (если ещё не установлены)
xcode-select --install

# Установка Rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Установка uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# Установка pnpm (если не установлен)
npm install -g pnpm
```

### Linux (Debian/Ubuntu)

```bash
# Системные зависимости для Tauri
sudo apt update
sudo apt install libwebkit2gtk-4.1-dev build-essential curl wget file \
  libxdo-dev libssl-dev libayatana-appindicator3-dev librsvg2-dev

# Установка Rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Установка uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# Установка pnpm
npm install -g pnpm
```

### Windows

```powershell
# Установка Rust через rustup (скачать с https://rustup.rs)
# Установка Microsoft C++ Build Tools (через Visual Studio Installer)
# Установка WebView2 (предустановлен в Windows 11)

# Установка uv
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"

# Установка pnpm
npm install -g pnpm
```

## Установка

```bash
# Клонирование репозитория
git clone https://github.com/atljh/codemancer.git
cd codemancer

# Установка фронтенд-зависимостей
pnpm install

# Установка бэкенд-зависимостей
cd backend && uv sync && cd ..
```

## Разработка

```bash
# Полное десктоп-приложение (Vite + Rust + Python бэкенд)
pnpm tauri dev

# Только фронтенд (Vite dev-сервер на http://localhost:1420)
pnpm dev

# Только бэкенд (FastAPI на http://127.0.0.1:8420)
cd backend && uv run python -m uvicorn main:app --host 127.0.0.1 --port 8420

# Проверка типов
pnpm exec tsc --noEmit
```

### Как это работает

1. `pnpm tauri dev` запускает Tauri-оболочку (Rust)
2. Tauri порождает Python FastAPI бэкенд как дочерний процесс на порту **8420**
3. Vite dev-сервер запускает React-фронтенд на порту **1420**
4. Фронтенд общается с бэкендом через HTTP/SSE

## Сборка для продакшена

```bash
# Сборка десктоп-приложения
pnpm tauri build
```

Собранное приложение будет в `src-tauri/target/release/bundle/`.

## Настройка

### Настройка AI-провайдера

При первом запуске открой **Настройки** (иконка шестерёнки) и настрой AI-провайдер:

| Провайдер     | Что нужно                                                          |
| ------------- | ------------------------------------------------------------------ |
| **Anthropic** | API-ключ или OAuth (вход через аккаунт Anthropic)                  |
| **OpenAI**    | API-ключ с platform.openai.com                                     |
| **Gemini**    | API-ключ с ai.google.dev                                           |
| **Custom**    | URL любого OpenAI-совместимого эндпоинта (Ollama, LM Studio и др.) |

### Рабочее пространство

Выбери директорию проекта через иконку папки в верхней панели. Codemancer просканирует её и построит дерево файлов, граф зависимостей и список квестов.

## Система EXP

| Действие               | EXP          |
| ---------------------- | ------------ |
| Отправка сообщения     | +10          |
| Сохранение файла       | +5           |
| Применение кода        | +50          |
| Исправление бага       | +100         |
| Git коммит             | варьируется  |
| Выполнение инструмента | +15-25       |
| Режим фокуса           | множитель x2 |

**Формула уровня**: `level = floor(sqrt(total_exp / 100))`

## Технологический стек

| Слой               | Технология                                            |
| ------------------ | ----------------------------------------------------- |
| Десктоп-оболочка   | Tauri 2.0 (Rust)                                      |
| Фронтенд           | React 19, TypeScript, Vite 7                          |
| Стилизация         | Tailwind CSS 4.2, Framer Motion 12                    |
| Стейт              | Zustand 5                                             |
| Редактор           | Monaco Editor                                         |
| Аудио              | Web Audio API (процедурный), Web Speech API (TTS/STT) |
| Иконки             | Lucide React                                          |
| Бэкенд             | Python 3.12+, FastAPI, Uvicorn                        |
| AI SDK             | anthropic, openai, google-genai                       |
| Пакетные менеджеры | pnpm (фронтенд), uv (бэкенд), cargo (Rust)            |

## Что дальше

- **Visual Vision** — возможность агента «видеть» UI запущенного приложения
- **Skill Trees** — прокачка навыков «Архитектора» или «Дебаггера», открывающая новые инструменты агента
- **Мульти-агентная оркестрация** — координация нескольких ИИ-агентов на сложных задачах
- **GitHub/CI интеграция** — ревью PR, мониторинг пайплайнов из командного центра

Codemancer — это твоя личная Цитадель в мире бесконечного кода. Пора перестать кодить и начать побеждать.

## Лицензия

MIT
